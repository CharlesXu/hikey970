# HiKey970开发板资料汇总
- Doc:
	- 01 hikey970烧录固件 - H-hikey(华为方案) - 深圳风火轮科技 - Powered by Discuz!.pdf
	- 02 华为HiAI DDK使用手册.pdf
	- 03 华为HiAI DDK集成手册.docx
	- 04 DevEco IDE使用指南.docx
	- 07 Hikey970编译.pdf
- Bin:
	- HiAI DDK.zip: https://pan.baidu.com/s/1t3pvByq2U-tQKO1Z5fftmA
	- DevEco IDE.zip: https://pan.baidu.com/s/1IQn2tEvVA1AJTsX-4fMzSQ
	- hikey970_fix_hdmi_storage.rar(2018/05/18): https://pan.baidu.com/s/19cTv_MoIgOKgJNZJO01t4Q
	- gcc-linaro-7.1.1-2017.08-x86_64_aarch64-linux-gnu.tar: https://pan.baidu.com/s/1OUmJMZL4UjnLpWBi5PrqKQ
- Hardware:
	- 开发板购买地址：https://item.taobao.com/item.htm?spm=a230r.1.14.16.2c705c98FLroqF&id=566806699719&ns=1&abbucket=17#detail
	- 散热风扇的安装：关键在于把正负极的插针分开，以便安装。否则由于卖家送的插针两个引脚的间距与板子的插口不匹配，导致无法安装。
	- 经过实际测试，散热风扇降温效果明显。
- Development
	- JDK 8 x86-64
	- Android Studio: https://dl.google.com/dl/android/studio/install/3.1.2.0/android-studio-ide-173.4720617-windows.exe
	- SDK Manager:https://dl.google.com/android/installer_r24.4.1-windows.exe
	- gradle-4.1-all.zip:https://pan.baidu.com/s/19iIQuC6HzZbDtad7Xt1edw
	- "Hello World" Project Steps:
		- a. 安装JDK、SDK Manger（安装目录不能包含空格）、Android Studio
		- b. 启动Android Studio后，在SDK Manager的位置，设置为之前安装的目录
		- c. 打开SDK Manager，下载Android SDK 26.0.2，不用设置代理，可直接下载
		- d. 新建一个hellow world项目。在编译构建时，下载gradle 4.4会耗时较长，只是慢，没有被墙
	- 注意事项：970开发板打开调制模式后，usb口的键盘和鼠标将无法使用，此时可使用蓝牙键盘鼠标代替。
	- "HiAIDemo" Project Steps:
		- a. 导入工程"Demo_Soure_Code"
		- b. 按"05 gradle-4.1-all.zip离线包下载 极速 android studio2.3 3.0编译必备 - zjgwh - 博客园",快速下载gradle-4.1-all.zip
		- c. 如图"06 hikey970 npu.png"所示，注释掉三行语句。因为无法获取到property，所以直接跳过即可
			![注释的语句](/06%20hikey970%20npu.png)
		- d. build运行到970开发板上
	- Hikey970源码编译注意事项：(根据07 Hikey970编译.pdf)
		- a. l-loader下的hikey970.mk中python命令需要用2.7版本
		- b. 编译BootLoader时出现fatal error: openssl/sha.h: No such file or directory错误：https://blog.csdn.net/xxxxxx91116/article/details/7927520(见08档)
		- c. python虚拟环境:
			- 生成虚拟环境：virtualenv -p /usr/bin/python2 py2env
			- 激活虚拟环境：source py2env/bin/activate
		- d. aosp下载：采用清华的源(https://mirrors.tuna.tsinghua.edu.cn/help/AOSP/);repo下载(https://mirrors.tuna.tsinghua.edu.cn/help/git-repo/).
    - Hikey970源码编译步骤: 
	    - sudo apt-get install -y git flex bison gperf build-essential libncurses5-dev:i386 
		- sudo apt-get install libx11-dev:i386 libreadline6-dev:i386 libgl1-mesa-dev g++-multilib 
		- sudo apt-get install tofrodos python-markdown libxml2-utils xsltproc zlib1g-dev:i386 
		- sudo apt-get install dpkg-dev libsdl1.2-dev libesd0-dev
		- sudo apt-get install git-core gnupg flex bison gperf build-essential  
		- sudo apt-get install zip curl zlib1g-dev gcc-multilib g++-multilib 
		- sudo apt-get install libc6-dev-i386 
		- sudo apt-get install lib32ncurses5-dev x11proto-core-dev libx11-dev 
		- sudo apt-get install lib32z-dev ccache libssl-dev
		- sudo apt-get install libgl1-mesa-dev libxml2-utils xsltproc unzip m4
		- sudo apt-get install selinux-utils
		- sudo apt-get install bc
		- init.common.rc line83注释 #关闭selinux
		- source ~/hikey970/bin/py2env/bin/activate #目的是使用python2.x
		- repo init -u https://aosp.tuna.tsinghua.edu.cn/platform/manifest -b master
		- git clone https://github.com/96boards-hikey/android-manifest.git -b hikey970_v1.0 .repo/local_manifests
		- repo sync 
		- source ./build/envsetup.sh
		- lunch hikey970-userdebug
		- make  -j32
		- 编译成功，编译大约耗时3.5h
			![AOSP编译成功](/09%20编译成功截图.PNG)
- 遗留问题
  - 970开发板如何使用摄像头？双目景深摄像头如何使用？
- 小技巧
  - 解决wifi connected, no internet: 指向小米的服务器
	- adb shell settings put global captive_portal_use_https 0
	- adb shell settings put global captive_portal_http_url http://connect.rom.miui.com/generate_204
  - 解决时钟同步,将ntp服务器指向阿里服务器
	- adb shell settings put global ntp_server  ntp5.aliyun.com
  - Android Termux
  	- pkg install git
	- pkg install gdb
	- pkg install strace
	- pkg install clang
	- pkg install vim
	- apt install python python-dev
